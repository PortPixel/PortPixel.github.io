"use strict";var cl=console.log;function openInMapsApp(t,e){-1!==navigator.platform.indexOf("iPhone")||-1!==navigator.platform.indexOf("iPod")?window.location="maps://maps.apple.com/maps?daddr="+t+","+e+"&amp;ll=":window.open("http://maps.google.com?daddr="+t+","+e+"&amp;ll=")}function b64EncodeUnicode(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode("0x"+e)}))}function b64DecodeUnicode(t){return decodeURIComponent(atob(t).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function iosCopyToClipboard(t){var e=t.contentEditable,n=t.readOnly,o=document.createRange();t.contentEditable=!0,t.readOnly=!1,o.selectNodeContents(t);var a=window.getSelection();a.removeAllRanges(),a.addRange(o),t.setSelectionRange(0,999999),t.contentEditable=e,t.readOnly=n,document.execCommand("copy")}function fallbackCopyTextToClipboard(t){var e=document.createElement("textarea");document.body.appendChild(e),e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(e)}function copyTextToClipboard(t){navigator.clipboard?navigator.clipboard.writeText(t).then(function(){},function(t){console.error(t)}):fallbackCopyTextToClipboard(t)}function setup(){var t=document.getElementById("locationButton");t.onclick=function(){t.classList.add("rainbowAnimated"),hideTitleTextElements(),setCurrentDataFromUserLocation(function(){t.classList.remove("rainbowAnimated"),currentData.time=Date.now(),updateUIFromCurrentData(),updateURL(),copyURL()})},t.onpointerdown=t.onclick;var e=document.getElementById("openInMapsContainer");e.onclick=function(){openInMapsApp(currentData.lat,currentData.lon)},e.onpointerdown=e.onclick;var n=document.getElementById("messageText");n.contentEditable=!0,n.oninput=function(){currentData.message=n.innerText,currentData.time=Date.now(),updateURL()};var o=document.getElementById("messageContainer");o.onclick=function(){n.focus()},o.onpointerdown=o.onclick,document.getElementById("copyLinkButton").onclick=function(){copyURL()},location.search.startsWith("?00")&&(hideTitleTextElements(),loadDataFromURL()),updateQRcode(),setInterval(updateTimeText,100);var a=document.getElementById("smallerTitleText");a.onclick=function(){showTitleTextElements(),currentData.init(),updateUIFromCurrentData(),window.history.pushState({},null,location.pathname),updateQRcode()},a.onpointerdown=a.onclick}function copyURL(){copyTextToClipboard(getLinkStr())}var qrcode,currentData={init:function(){this.message="",this.lat=0,this.lon=0,this.time=Date.now()}};function setCurrentDataFromUserLocation(t){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var n=e.coords.latitude,o=e.coords.longitude;currentData.lat=n,currentData.lon=o,t()},function(e){console.error(e),t()}):console.error("Geolocation not supported by browser")}function getLinkStr(){return location.href}function updateUIFromCurrentData(){document.getElementById("messageText").innerHTML=currentData.message,document.getElementById("detailsText").innerHTML="Lat: "+currentData.lat.toFixed(6)+"\n    <br>\n    Lon: "+currentData.lon.toFixed(6),updateTimeText(),updateLinkStrEle()}function getReadableStringForTimestamp(t){var e=new Date(t);return e.getFullYear()+"."+String(e.getMonth()+1).padStart(2,"0")+"."+String(e.getDate()).padStart(2,"0")+" "+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")+":"+String(e.getSeconds()).padStart(2,"0")}function convertTimeDeltaToHumanReadableStr(t){return t>=314046e5?(t/31536e6).toFixed(1)+" yrs":t>=258768e4?(t/2592e6).toFixed(1)+" months":t>=8622e4?(t/864e5).toFixed(1)+" days":t>=3597e3?(t/36e5).toFixed(1)+" hrs":t>=59950?(t/6e4).toFixed(1)+" minutes":(t/1e3).toFixed(1)+" seconds"}function updateTimeText(){var t=Date.now()-currentData.time;document.getElementById("timeText").innerHTML=convertTimeDeltaToHumanReadableStr(t)+" ago\n    <br>\n    "+getReadableStringForTimestamp(currentData.time)}function updateLinkStrEle(){document.getElementById("linkAsText").value=getLinkStr()}function genURLFromCurrentData(){var t=currentData.lat.toString().split("."),e=currentData.lon.toString().split(".");return 1===t.length&&t.push("0"),1===e.length&&e.push("0"),"00&"+(parseInt(t[0]).toString(36)+"."+parseInt(t[1]).toString(36)+"&"+parseInt(e[0]).toString(36)+"."+parseInt(e[1]).toString(36))+"&"+b64EncodeUnicode(currentData.message)+"&"+currentData.time.toString(36)}function loadDataFromURL(){var t=location.search.substring(1).split("&");if("00"===t[0]){var e=t[1].split(".");currentData.lat=1*(parseInt(e[0],36)+"."+parseInt(e[1],36));var n=t[2].split(".");currentData.lon=1*(parseInt(n[0],36)+"."+parseInt(n[1],36)),currentData.message=b64DecodeUnicode(t[3]),currentData.time=parseInt(t[4],36),updateUIFromCurrentData()}else cl("different version, not loading data")}function updateURL(){window.history.pushState({},null,location.pathname+"?"+genURLFromCurrentData()),updateLinkStrEle(),updateQRcode()}function updateQRcode(){qrcode&&(qrcode.clear(),document.getElementById("qrcode").innerHTML=""),qrcode=new QRCode(document.getElementById("qrcode"),location.href)}function hideTitleTextElements(){document.getElementById("mainDataContainer").style.visibility="visible",document.getElementById("titleContainer").style.visibility="hidden"}function showTitleTextElements(){document.getElementById("mainDataContainer").style.visibility="hidden",document.getElementById("titleContainer").style.visibility="visible"}currentData.init();
